from config import TOOL_PATHS


def build_exploit_command(tool_name: str, params: dict) -> list[str]:
    if tool_name == "searchsploit":
        query = params.get("query", "").strip()
        cve = params.get("cve", "").strip()
        if not query and not cve:
            return []
        cmd = [TOOL_PATHS["searchsploit"]]
        if params.get("json"):
            cmd.append("--json")
        if params.get("exact"):
            cmd.append("--exact")
        if params.get("www"):
            cmd.append("--www")
        if params.get("mirror"):
            cmd.append("--mirror")
        if params.get("path"):
            cmd.append("--path")

        exclude = params.get("exclude", "").strip()
        if exclude:
            cmd.extend(["--exclude", exclude])

        if cve:
            cmd.extend(["--cve", cve])

        extra = params.get("extra_flags", "").strip()
        if extra:
            cmd.extend(extra.split())

        if query:
            cmd.append(query)
        return cmd

    return []
