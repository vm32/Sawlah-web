from config import TOOL_PATHS


def build_exploit_command(tool_name: str, params: dict) -> list[str]:
    if tool_name == "searchsploit":
        query = params.get("query", "").strip()
        if not query:
            return []
        cmd = [TOOL_PATHS["searchsploit"]]
        if params.get("json"):
            cmd.append("--json")
        if params.get("exact"):
            cmd.append("--exact")
        if params.get("www"):
            cmd.append("--www")
        extra = params.get("extra_flags", "").strip()
        if extra:
            cmd.extend(extra.split())
        cmd.append(query)
        return cmd

    return []
